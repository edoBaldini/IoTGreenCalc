<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.0.10/css/all.css'>
<!--     <link rel="stylesheet" href="../static/css/style.css">
 -->    <script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>

  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js'></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>


  <title>IoT model</title>

  </head>
 <body>
 {% extends "header.html" %}
 {% block content %}
  <div class="h-100">
    <div class="masthead">
      <div class="masthead-bg"></div>
      <div class="h-100">
        <div class="row">
          <div style="padding-left: 3%; width: min-content;"> 
            <div class="align-self-center my-auto">
              <nav class="navbar small-rounded-nav" >
                <form class="form-holder" id="form1" action="/" method="POST" enctype="multipart/form-data">
                  <ul class="navbar-nav">
                    <li class="navbar-item">
                      <a id="Device" class="btn btn-outline-success list-group-item-action nav-fields-settings" href="{{url_for('home.index')}}"><img style="width:20%" src="../static/img/home.svg" alt="home">
Back</a> <br />
                    </li>
                    <li class="navbar-item">
                      <a id="Device" class="btn btn-outline-success list-group-item-action nav-fields-settings" href="{{url_for('device.create_device')}}">Device</a> <br />
                    </li>
                    <li class="navbar-item">
                      <a id="Solar Panel" class="btn btn-outline-success list-group-item-action nav-fields-settings" href="{{url_for('solar_panel.create_solar_panel')}}">Solar Panel</a><br />
                    </li>
                    <li class="navbar-item">  
                      <a id="Battery" class="btn btn-outline-success list-group-item-action nav-fields-settings" href="{{url_for('battery.create_battery')}}">Battery</a><br />
                    </li>
                    <li class="navbar-item">
                      {% if device and battery and solar_panel%}
                        <a id="Maintenance" class="btn btn-outline-success list-group-item-action nav-fields-settings" href="{{url_for('maintenance.create_maintenance')}}">Maintenance</a><br />
                      {% else %}
                        <a id="Maintenance" class="btn btn-outline-success nav-fields-settings disabled ">Maintenance</a><br />
                      {% endif %} 
                    </li>
                  </ul>
                </form>
              </nav>
            </div>
          </div>
          {% if device_bool %}
          <div class="" style="padding-left: 3%; width: min-content;"> 
            <div class="align-self-center my-auto">
                <nav class="navbar small-rounded-nav" >
                  <form class="form-holder" id="form1" action="/" method="POST" enctype="multipart/form-data">
                    <ul class="navbar-nav">
                      <li class="navbar-item">
                        <a id="Maintenance" class="btn btn-outline-success list-group-item-action nav-fields-settings" href="{{url_for('device.radio')}}">Radio</a><br />
                      </li>
                      <li class="navbar-item">
                        <a id="Battery" class="btn btn-outline-success list-group-item-action nav-fields-settings" href="{{url_for('device.board')}}">Boards</a><br />
                      </li>
                      <li class="navbar-item">
                        <a id="Solar Panel" class="btn btn-outline-success list-group-item-action nav-fields-settings" href="{{url_for('device.sensor')}}">Sensors</a><br />
                      </li>
                      <li class="navbar-item">
                        <a id="Maintenance" class="btn btn-outline-success list-group-item-action nav-fields-settings" href="{{url_for('device.processor')}}">Processor</a><br />
                      </li>
                      <li class="navbar-item">
                        <a id="Device" class="btn btn-outline-success list-group-item-action nav-fields-settings" href="{{url_for('device.configuration')}}">Configuration</a> <br />
                      </li>
                  </form>
                </nav>
            </div>
          </div>
          {% elif energy_ratio %}
          <div class="col-sm-2"> </div>
          {% else %}
          <div class=" col-sm-2 leftbox-color"> 
            <div class="align-self-center my-auto">
                <nav class="navbar small-rounded-nav" style="background-color:transparent;"  >
                  <form class="form-holder" id="form1" action="/" method="POST" enctype="multipart/form-data">
                    <ul class="navbar-nav">
                      <li class="navbar-item"> 
                        <a id="Maintenance" style="color:transparent" href="{{url_for('device.radio')}}">Radio</a><br />
                      </li>
                      <li class="navbar-item">
                        <a id="Battery" style="color:transparent" href="{{url_for('device.board')}}">Boards</a><br />
                      </li>
                      <li class="navbar-item">
                        <a id="Solar Panel" style="color:transparent" href="{{url_for('device.sensor')}}">Sensors</a><br />
                      </li>
                      <li class="navbar-item">
                        <a id="Maintenance" style="color:transparent" href="{{url_for('device.processor')}}">Processor</a><br />
                      </li>
                      <li class="navbar-item">
                        <a id="Device" style="color:transparent" href="{{url_for('device.configuration')}}">Configuration</a> <br />
                      </li>
                  </form>
                </nav>
            </div>
          </div>
          {% endif %}

        <div class="row col-12" style="padding-top:5%; padding-left:2.7%">
        {% if e_values %}
<!--         <div class="col-sm-2 align-self-center" style="text-align: center; color: #f7eded"> <h7 style="font-weight:bold;"> Energy impact of your solution</h7> <h1 style="color:#e24b49"> <span style="font-size:80px; ">{{energy_ratio}}</span>x</h1>
          <h7 style="font-weight:bold;">than the green impact</h7></div> -->
          <div class = "align-self-center col-sm-5 canvas-color" style="float: none; margin: 0 auto; text-align:center;border-radius: 30px">
            <div class="row" style="justify-content:center">
            <canvas class="" id="myChart" width="450px" height="300"></canvas>
            <script>
            var ctx = document.getElementById('myChart').getContext('2d');
            var myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [
                      {% for i in labels %}
                        "{{i}}",
                      {% endfor %}
                    ],
                    datasets: [{
                        label: 'Your solution',
                        data: [
                        {% for v in e_values %}
                          "{{v}}",
                        {% endfor %}
                        ],
                        // backgroundColor: [
                        //     'rgba(255, 99, 132, 0.2)',
                        //     'rgba(54, 162, 235, 0.2)',
                        //     'rgba(255, 206, 86, 0.2)',
                        //     'rgba(75, 192, 192, 0.2)'
                        // ],
                        backgroundColor: [
                            '#e24b49',
                            '#e24b49',
                            '#e24b49',
                            '#e24b49'
                        ],
                        // borderColor: [
                        //     'rgba(255, 99, 132, 1)',
                        //     'rgba(54, 162, 235, 1)',
                        //     'rgba(255, 206, 86, 1)',
                        //     'rgba(75, 192, 192, 1)'
                        // ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(255, 99, 132, 1)',
                            'rgba(255, 99, 132, 1)',
                            'rgba(255, 99, 132, 1)'
                        ],
                        borderWidth: 1
                    },
                    {
                        label: 'Green solution',
                        data: [
                        {% for g in e_g_values %}
                          "{{g}}",
                        {% endfor %}
                        ],
                        backgroundColor: [
                            '#00b894',
                            '#00b894',
                            '#00b894',
                            '#00b894'
                        ],
                        borderColor: [
                            'rgba(126, 211, 134, 1)',
                            'rgba(126, 211, 134, 1)',
                            'rgba(126, 211, 134, 1)',
                            'rgba(126, 211, 134, 1)'
                        ],
                        borderWidth: 1
                    }],
            
                },
                options: {
                  responsive: false,
                  title: {
                    display: true,
                    text: 'Energy impact (MJ)',
                    fontFamily: 'Lora',
                    fontSize: 20,
                    fontColor: 'rgba(255, 255, 255, 0.85)',
                    lineHeight: 1.4
                  },
                  tooltips: {
                      enabled: true
                  },
                  hover: {
                      animationDuration: 1
                  },
                  scales: {
                    yAxes: [{
                      display: false,
                      gridLines: {
                          drawBorder: false,
                      }
                    }],
                    xAxes: [{
                      //display: false, // this will hide vertical lines
                      ticks: {
                        fontFamily: 'Lora',
                        fontSize: 16,
                        fontColor: "rgba(255, 255, 255, 0.85)"
                      },
                      gridLines: {
                          display: false,
                          drawBorder: false,
                      }
                    }],
                  },
                  animation: {
                    duration: 1,
                    onComplete: function () {
                      var chartInstance = this.chart,
                      ctx = chartInstance.ctx;
                      ctx.textAlign = 'center';
                      ctx.fillStyle = "rgba(255, 255, 255, 0.85)";
                      ctx.textBaseline = 'bottom';
                      // ctx.font = Chart.helpers.fontString('Lora', 'small', 'Lora');
                      ctx.font = "16px Lora";
                      this.data.datasets.forEach(function (dataset, i) {
                        var meta = chartInstance.controller.getDatasetMeta(i);
                        meta.data.forEach(function (bar, index) {
                          var data = dataset.data[index];
                          ctx.fillText(data, bar._model.x, bar._model.y - 5);
                        });
                      });
                    }
                  },
                  legend: {
                    display: false
                  }
              }
            });
            </script>
          </div>
          <div class="row" style="justify-content: center">
            <h1 style="color:rgba(255, 255, 255, 0.85)"> <span style="font-size:80px; ">{{energy_ratio}}</span>x</h1>
          </div>
          <div class="row" style="justify-content: center; padding-bottom:10px">
          <h7> than the green solution</h7>
        </div>
            {% endif %}
            {% if form %}
             <div class = "align-self-center col-sm-6" style="float: none; margin: 0 auto;">

              {% if title_form == 'Boards' or title_form == 'Sensors'%}
                {% set l = form|length - 1%}
                  <form id="form2" action="" method="POST" enctype="multipart/form-data"> 
                    <button class="button buttonJeans" type="submit" name="add" value="add">Add</button>
                  </form>

                <div id="accordion">
                {% for f in form %}
                  {% set counter = loop.index0 %}
                    <div class="card card-color">
                      <div class="card-header">
                        <a style="color: rgba(255, 255, 255, 0.85)" class="card-link color-link" data-toggle="collapse" href="#collapse{{counter}}">
                          {{title_form}} {{counter}}
                        </a>
                      </div>
                      {% if counter == 0 %}
                        <div id="collapse{{counter}}" class="collapse show" data-parent="#accordion">
                      {% else %}
                        <div id="collapse{{counter}}" class="collapse" data-parent="#accordion">
                      {% endif %}

                        <div class="card-body card-b-color">
                          <form class="form-group" style="padding-left:15%" action="" method="POST">
                            {{ f.hidden_tag() }}
                            <h2 class="formTitle">{{title_form}}</h2>
                            <fieldset>
                              <div class="form-group row">
                              {% for field in f.display %}
                                <div class="col-sm-6">
                                <label for="{{ field }}" >{{ f[field].label }}</label>
                                </div>
                                <div class="col-auto">
                                {{ f[field](class_="f-control col-auto")}}
                                {% if f[field].errors %}
                                  {% for e in f[field].errors %}
                                    <p class="help-block" style="color:red;">{{ e }} Check the type inserted</p>
                                  {% endfor %}
                                {% endif %}
                              </div>
                              {% endfor %} 
                              </div>     
                            </fieldset>
                            <button class="button buttonJeans" type="submit" name="submit" value="{{counter}}">Submit</button>
                            {% if f.active_mode.data%}
                              <button class="button buttonJeans" type="delete" name="delete" value="{{counter}}">   Delete</button>
                            {% endif %}
                            {% if title_form=='Boards' and f.weight.data%}
                              <button class="button buttonJeans" type="delete" name="delete" value="{{counter}}">   Delete</button>
                            {% endif %}
                          </form>
                        </div>
                      </div>
                    </div>
                {% endfor %}
                </div>
              {% else %}
                <!-- <form class="form-group" action="" method="POST">
                  {{ form.hidden_tag() }}
                  <h2 class="formTitle">{{title_form}}</h2>
                  <fieldset>
                    {% for field in form.display %}
                      <label for="{{ field }}" >{{ form[field].label }}</label>
                      {{ form[field](class_="form-control col-md-2")}}
                      {% if form[field].errors %}
                        {% for e in form[field].errors %}
                          <p class="help-block" style="color:red;">{{ e }} Check the type inserted</p>
                        {% endfor %}
                      {% endif %}
                    {% endfor %}      
                  </fieldset>
                  <button class="button buttonJeans" type="submit">Submit</button>
                </form> -->
              <div id="accordion">
                    <div class="card card-color">
                      <div id="collapse" class="" data-parent="#accordion">
                        <div class="card-body card-b-color">
                          <form class="form-group" style="padding-left:15%" action="" method="POST">
                            {{ form.hidden_tag() }}
                            <h2 class="formTitle">{{title_form}}</h2>
                            <fieldset>
                              <div class="form-group row">
                              {% for field in form.display %}
                                <div class="col-sm-6">
                                <label for="{{ field }}" >{{ form[field].label }}</label>
                                </div>
                                <div class="col-auto">
                                {{ form[field](class_="f-control col-auto")}}
                                {% if form[field].errors %}
                                  {% for e in form[field].errors %}
                                    <p class="help-block" style="color:red;">{{ e }} Check the type inserted</p>
                                  {% endfor %}
                                {% endif %}
                              </div>
                              {% endfor %} 
                              </div>     
                            </fieldset>
                            <button class="button buttonJeans" type="submit" name="submit" value="{{counter}}">Submit</button>
                          </form>
                        </div>
                      </div>
                    </div>
                </div>

              {% endif %}
            {% endif %}
          </div>
          {% if w_values %}
          <div class = "align-self-center col-sm-5 canvas-color" style="float: none; margin: 0 auto; text-align:center;border-radius: 30px">
            <div class="row" style="justify-content:center">
          <canvas class=""  id="myChart2" width="450px" height="300"></canvas>
            <script>
            var ctx = document.getElementById('myChart2').getContext('2d');
            var myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [
                      {% for i in labels %}
                        "{{i}}",
                      {% endfor %}
                    ],
                    datasets: [{
                        label: 'Your solution',
                        data: [
                        {% for v in w_values %}
                          "{{v}}",
                        {% endfor %}
                        ],
                        // backgroundColor: [
                        //     'rgba(255, 99, 132, 0.2)',
                        //     'rgba(54, 162, 235, 0.2)',
                        //     'rgba(255, 206, 86, 0.2)',
                        //     'rgba(75, 192, 192, 0.2)'
                        // ],
                        backgroundColor: [
                            '#e24b49',
                            '#e24b49',
                            '#e24b49',
                            '#e24b49'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(255, 99, 132, 1)',
                            'rgba(255, 99, 132, 1)',
                            'rgba(255, 99, 132, 1)'
                        ],
                        borderWidth: 1
                    },
                    {
                        label: 'Green solution',
                        data: [
                        {% for g in w_g_values %}
                          "{{g}}",
                        {% endfor %}
                        ],
                        backgroundColor: [
                            '#00b894',
                            '#00b894',
                            '#00b894',
                            '#00b894'
                        ],
                        borderColor: [
                            'rgba(126, 211, 134, 1)',
                            'rgba(126, 211, 134, 1)',
                            'rgba(126, 211, 134, 1)',
                            'rgba(126, 211, 134, 1)'
                        ],
                        borderWidth: 1
                    }],
            
                },
                options: {
                  responsive: false,
                  title: {
                    display: true,
                    text: ['Waste impact (g)',''],
                    fontFamily: 'Lora',
                    fontSize: 20,
                    fontColor: 'rgba(255, 255, 255, 0.85)'
                  },
                  tooltips: {
                      enabled: true
                  },
                  hover: {
                      animationDuration: 1
                  },
                  scales: {
                    yAxes: [{
                      display: false,
                      gridLines: {
                          drawBorder: false,
                      }
                    }],
                    xAxes: [{
                      //display: false, // this will hide vertical lines
                      ticks: {
                        fontFamily: 'Lora',
                        fontSize: 16,
                        fontColor: "rgba(255, 255, 255, 0.85)"
                      },
                      gridLines: {
                          display: false,
                          drawBorder: false,
                      }
                    }],
                  },
                  animation: {
                    duration: 1,
                    onComplete: function () {
                      var chartInstance = this.chart,
                      ctx = chartInstance.ctx;
                      ctx.textAlign = 'center';
                      ctx.fillStyle = "rgba(255, 255, 255, 0.85)";
                      ctx.textBaseline = 'bottom';
                      // ctx.font = Chart.helpers.fontString('Lora', 'small', 'Lora');
                      ctx.font = "16px Lora";
                      this.data.datasets.forEach(function (dataset, i) {
                        var meta = chartInstance.controller.getDatasetMeta(i);
                        meta.data.forEach(function (bar, index) {
                          var data = dataset.data[index];
                          ctx.fillText(data, bar._model.x, bar._model.y - 5);
                        });
                      });
                    }
                  },
                  legend: {
                    display: false
                  }
              }
            });
            </script>
          </div>
          <div class="row" style="justify-content: center;">
            <h1 style="color:rgba(255, 255, 255, 0.85)"> <span style="font-size:80px; ">{{waste_ratio}}</span>x</h1>
            
          </div>
          <div class="row" style="justify-content: center; padding-bottom:10px">
            <h7> than the green solution</h7>
          </div>
        </div>
<!--         <div class="col-sm-2" style="text-align: center"> </p> <h1> <span style="font-size:80px">{{energy_ratio}}</span>x</h1></div>
 -->            {% endif %}

      </div>
      
    </div>
  </div>
  {% endblock %}
  </body>
</html>
